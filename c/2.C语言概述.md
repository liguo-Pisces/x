# C语言概述

## 简单的C程序示例

```c
/* 一个简单的C程序 */
#include <stdio.h>

int main(void)
{
    int num;
    num = 1;
    
    printf("I am a simple ");
    pirntf("computer.\n");
    printf("My favorite number is %d because it is first.\n", num);
    
    return 0;
}
```

## 示例解释

### #include指令和头文件

#include这行代码是一条 C预处理指令（preprocessor directive）。通常，C编译器在编译前会对源代码做一些准备工作，即预处理（preprocessing）。

通常，在C程序顶部的信息集合被称为头文件（header）。在大多数情况下，头文件包含了编译器创建最终可执行程序要用到的信息。简而言之，头文件帮助编译器把你的程序正确地组合在一起。

### main函数

C程序一定从main()函数开始执行（目前不必考虑例外的情况）。除了main()函数，你可以任意命名其他函数，而且main()函数必须是开始的函数。

### 注释

在程序中，被 /\* \*/ 开两个符号括起来的部分是程序的注释。写注释能让他人（包括自己）更容易明白你所写的程序。C语言注释的好处之一是，可将注释放在任意的地方，甚至是与要解释的内容在同一行。较长的注释可单独放一行或多行。在 /\* 和  */ 之间的内容都会被编译器忽略。

C99新增了另一种风格的注释，普遍用于C++和Java。这种新风格使用//符号创建注释，仅限于单行。

### 花括号、函数体和块

一般而言，所有的C函数都使用花括号标记函数体的开始和结束。这是规定，不能省略。只有花括号能起这种作用，圆括号和方括号都不行。

花括号还可用于把函数中的多条语句合并为一个单元或块。

### 声明

声明是C语言最重要的特征之一。

`int num;`

这行代码叫作声明（declaration）。在该例中，声明完成了两件事情。其一，在函数中有一个名为num的变量（variable）。其二，int表明num是一个整数（即，没有小数点或小数部分的数）。int是一种数据类型。编译器使用这些信息为num变量在内存中分配存储空间。分号在C语言中是大部分语句和声明的一部分，不像在Pascal中只是语句间的分隔符。

int是C语言的一个关键字（keyword），表示一种基本的C语言数据类型。关键字是语言定义的单词，不能做其他用途。

示例中num是一个标识符（identifier），也就一个变量、函数或其他实体的名称。因此，声明把特定标识符与计算机内存中的特定位置联系起来，同时也确定了储存在某位置的信息类型或数据类型。

在C语言中，所有变量都必须先声明才能使用。这意味着必须列出程序中用到的所有变量名及其类型。

以前的C语言，还要求把变量声明在块的顶部，其他语句不能再任何声明的前面。C99和C11遵循C++的惯例，可以把声明放在块中的任何位置。尽管如此，首次使用变量之前一定要先声明它。为了与旧系统更好地兼容，最好沿用最初的规则。

#### 数据类型

C语言可以处理多种类型的数据。把变量声明为指定类型，计算机才能正确地储存、读取和解释数据。

#### 命名

给变量命名时要使用有意义的变量名或标识符。如果变量名无法清楚地表达自身的用途，可在注释中进一步说明。这是一种良好的编程习惯和编程技巧。

C99和C11允许使用更长的标识符名，但是编译器只识别前63个字符。对于外部标识符，只允许使用31个字符。

可以用小写字母、大写字母、数字和下划线（_）来命名。而且，名称的第1个字符必须是字符或下划线，不能是数字。

操作系统和C库经常使用一个或两个下划线字符开始的标识符，因此最好避免在自己的程序中使用这种名称。

C语言的名称区分大小写，即把一个字母的大写和小写视为两个不同的字符。

为了让C语言更加国际化，C99和C11根据通用字符名（即UCN）机制添加了扩展字符集。其中包含了除英文字母意外的部分字符。

#### 声明变量的4个理由

* 把所有的变量放在一处，方便读者查找和理解程序的用途。
* 声明变量会促使你在编写程序之前做一些计划。
* 声明变量有助于发现隐藏在程序中的小错误，如变量名拼写错误。
* 如果事先未声明变量，C程序将无法通过编译。

### 赋值

赋值是C语言的基本操作之一。

`num = 1;`

这行代码是赋值表达式语句。该行代码的意思是“把值1赋给变量num”。在执行`int num;`声明时，编译器在计算机内存中为变量num预留了空间，然后在执行这行赋值表达式语句时，把值储存在之前预留的位置。可以给num赋不同的值，这就是num之所以被称为变量（variable）的原因。注意，该赋值表达式语句从右侧把值赋到左侧。另外，该语句以分号结尾。

### 函数

在C语言中，实际参数（简称实参）是传递给函数的特定值，形式参数（简称形参）是函数中用于储存值得变量。

在C语言中调用函数。只需要输入函数名，把所需的参数填入圆括号即可。当程序运行到这一行时，控制权被转给已命名的函数。函数执行结束后，控制权被返回至主调函数（calling function）。

### return语句

有返回的C函数要有return语句。该语句以return关键字开始，后面试待返回的值，并以分号结尾。

## 简单程序的结构

程序由一个或多个函数组成，必须有main()函数。函数由函数头和函数体组成。函数头包括函数名、传入该函数的信息类型和函数的返回类型。通过函数名后的圆括号可识别出函数，圆括号里可能为空，可能有参数。函数体被花括号括起来，由一系列语句、声明组成。最后，main()以return语句结束。

## 提高程序可读性的技巧

编写可读性高的程序是良好的编程习惯。可读性高的程序更容易理解，以后也更容易修改和更正。提高程序的可读性还有助于你理清编程思路。

* 选择有意义的函数名和写注释。注意，使用这两种技巧时应相得益彰，避免重复啰嗦。
* 在函数中用空行分割概念上的多个部分。
* 每条语句各占一行。

## 多个函数

* 函数原型（prototype），告知编译器在程序中要使用该函数。
* 函数调用（function call）
* 函数定义（function definition），函数定义即函数本身的源代码。

C90标准新增了函数原型，旧式的编译器可能无法识别。函数原型是一种声明形式，告知编译器正在使用某函数，因此函数原型也被称为函数声明（function declaration）。函数原型还指明了函数的属性。

## 调试程序

程序的错误通常叫做bug，找出并修正错误的过程叫做调试（debug）。

如果不遵循C语言的规则就会犯语法错误。

语义错误是指意思上的错误。编译器无法检测语义错误，因为这类错误并未违反C语言的规则。编译器无法了解你的真正意图，所以你只能自己找出这些错误。

程序状态（program state）是在程序的执行过程中，某给定点上所有变量值得集合。它是计算机当前状态的一个快照。

* 自己模拟计算机逐步执行程序。
* 在程序中的关键点插入额外的printf()语句，以监视制定变量值的变化。
* 使用调试器。调试器（debugger）是一种程序，让你一步一步运行另一个程序，并检查该程序变量的值。

## 关键字和保留标识符

关键字是C语言的词汇。它们对C而言比较特殊，不能用它们作为标识符。

ISO C关键字

| auto     | extern   | short    | while          |
| -------- | -------- | -------- | -------------- |
| break    | float    | signed   | _Alignas       |
| case     | for      | sizeof   | _Alignof       |
| char     | goto     | static   | _Atomic        |
| const    | if       | struct   | _Bool          |
| continue | inline   | switch   | _Complex       |
| default  | int      | typedef  | _Generic       |
| do       | long     | union    | _Imaginary     |
| double   | register | unsigned | _Noreturn      |
| else     | restrict | void     | _Static_assert |
| enum     | return   | volatile | _Thread_local  |

如果使用关键字不当（如，用关键字作为变量名），编译器会将其视为语法错误。还有一些保留标识符（reserved identifier），C语言已经指定了它们的用途或保留它们的使用权，如果你使用这些标识符来表示其他意思会导致一些问题。

## 总结

C程序由一个或多个C函数组成。每个C程序必须包含一个main()函数，这是C程序要调用的第一个函数。简单的函数由函数头和后面的一对花括号组成，花括号是由声明、语句组成的函数体。

在C语言中，大部分语句都以分号结尾。声明为变量创建变量名和标识该变量中储存的数据类型。变量名是一种标识符。赋值表达式语句把值赋给变量，或者更一般地说，把赋值给存储空间。函数表达式语句用于调用指定的已命名函数。低昂函数执行完毕后，程序会返回到函数调用后面的语句继续执行。

一门语言的语法是一套规则，用于管理语言中各有效语句组合在一起的方式。语句的语义是语句要表达的意思。编译器可以检测出语法错误，但是程序里的语义错误只有在编译完之后才能从程序的行为中表现出来。检查程序是否有语义错误要跟踪程序的状态，即程序每执行一步后所有变量的值。

最后，关键字是C语言的词汇。

